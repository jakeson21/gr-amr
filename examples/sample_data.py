import matplotlib.pyplot as plt
import numpy as np
from scipy import signal

bps = 9600.
fs = 96000.
spb = int(fs/bps)

x = np.array([-0.16043059527873993, 0.08113955706357956, -0.007017368450760841, -0.07289275527000427, -0.027802463620901108, 0.0758625715970993, 0.052561886608600616, -0.010707177221775055, -0.05983193963766098, -0.010229051113128662, 0.09105976670980453, 0.030646685510873795, -0.022408880293369293, -0.052355989813804626, 0.05067916959524155, 0.028145140036940575, 0.003124631941318512, -0.024623490869998932, 0.01377774402499199, 0.062332119792699814, -0.05601973831653595, 0.03947173058986664, 0.05295167863368988, -0.07642706483602524, -0.030575092881917953, 0.06944876164197922, 0.01756817288696766, -0.022017069160938263, 0.016606461256742477, 0.025312837213277817, 0.027728600427508354, 0.000867404043674469, 0.07370145618915558, -0.050878070294857025, -0.030021987855434418, 0.04410265386104584, -0.06285986304283142, 0.02405676245689392, 0.0774231106042862, -0.04293403774499893, -0.03779660537838936, 0.08685346692800522, -0.05273064225912094, 0.017117062583565712, 0.04415584355592728, -0.061392202973365784, 0.0928327664732933, -0.0047683436423540115, -0.07164808362722397, 0.05277477949857712, 0.07359418272972107, -0.08693496137857437, 0.0338919498026371, 0.03638099133968353, -0.005795756354928017, 0.0010747946798801422, -0.03389088809490204, 0.10389447212219238, -0.03559139370918274, -0.011228349059820175, 0.00467447005212307, 0.0161264780908823, 0.01550842821598053, -0.01792595162987709, -0.005847020074725151, 0.009197928011417389, 0.037310853600502014, 0.031600989401340485, 0.021733764559030533, -0.032103877514600754, 0.08084598183631897, -0.054564423859119415, -0.005065178498625755, 0.05590071901679039, -0.05699634552001953, 0.07724735140800476, 0.05639415606856346, -0.07353293895721436, 0.0813610777258873, -0.4387361407279968, -1.224621057510376, -1.4242465496063232, -1.326798439025879, -1.3909666538238525, -1.308696985244751, -1.315342664718628, -1.3825404644012451, -1.3226544857025146, -1.3706083297729492, -1.320448637008667, -1.3536272048950195, -1.276430368423462, -1.409665584564209, -1.3507812023162842, -1.3284175395965576, -1.3788220882415771, -1.2804341316223145, -1.4010488986968994, -1.320216178894043, -0.5913485288619995, 1.3029260635375977, 1.3764290809631348, 1.360133171081543, 1.3684413433074951, 1.3401298522949219, 1.30607271194458, 1.3795361518859863, 1.442352056503296, 1.3642487525939941, 0.6281223893165588, -1.285768747329712, -1.4084107875823975, -1.3909595012664795, -1.2811801433563232, -1.2663908004760742, -1.3473505973815918, -1.411581039428711, -1.3293108940124512, -1.4576942920684814, -0.49037593603134155, 1.3086702823638916, 1.2615740299224854, 1.454392671585083, 1.2649660110473633, 1.424842119216919, 1.2944462299346924, 1.3818161487579346, 1.4691455364227295, 1.354405164718628, 0.5702041387557983, -1.270824670791626, -1.3067727088928223, -1.3701167106628418, -1.361579418182373, -1.3493857383728027, -1.3141729831695557, -1.289332389831543, -1.4428355693817139, -1.3770549297332764, -0.6601466536521912, 1.3071460723876953, 1.363527536392212, 1.4107725620269775, 1.3826162815093994, 1.3802690505981445, 1.2616779804229736, 1.3825199604034424, 1.4720966815948486, 1.3119163513183594, 0.5876359343528748, -1.2771978378295898, -1.3310680389404297, -1.329843521118164, -1.3664674758911133, -1.3083572387695312, -1.3117055892944336, -1.3270845413208008, -1.3844304084777832, -1.4433937072753906, -0.5757482647895813, 1.2808358669281006, 1.361253023147583, 1.4512436389923096, 1.2802648544311523, 1.3202259540557861, 1.3641207218170166, 1.3711955547332764, 1.4214541912078857, 1.3428332805633545, 0.6881991028785706, -1.2781891822814941, -1.368910312652588, -1.3901948928833008, -1.297640085220337, -1.3056421279907227, -1.3331804275512695, -1.3417794704437256, -1.3959999084472656, -1.4061882495880127, -0.6108168363571167, 1.2766082286834717, 1.3398959636688232, 1.316676378250122, 1.3782200813293457, 1.3756065368652344, 1.354116439819336, 1.3696644306182861, 1.4236278533935547, 1.3289768695831299, 0.6879469156265259, -1.2872114181518555, -1.2380871772766113, -1.4515342712402344, -1.3090851306915283, -1.4372031688690186, -1.2196359634399414, -1.3633217811584473, -1.3760149478912354, -1.3450946807861328, -0.7019659280776978, 1.2959682941436768, 1.3394031524658203, 1.3685119152069092, 1.3654897212982178, 1.2958710193634033, 1.4208950996398926, 1.388941764831543, 1.3612284660339355, 1.4025168418884277, 0.5970928072929382, -1.1861448287963867, -1.3390107154846191, -1.3272409439086914, -1.373518943786621, -1.3814873695373535, -1.2582767009735107, -1.3768703937530518, -1.4315471649169922, -1.3040480613708496, -0.7215234041213989, 1.2980849742889404, 1.3005290031433105, 1.5208258628845215, 1.3252995014190674, 1.3324131965637207, 1.3164546489715576, 1.3176774978637695, 1.462113857269287, 1.3302114009857178, 0.7063091993331909, -1.2791087627410889, -1.3057842254638672, -1.4255561828613281, -1.332392930984497, -1.2896389961242676, -1.3069543838500977, -1.3048968315124512, -1.4709200859069824, -1.2998151779174805, -0.7071008682250977, 1.2468791007995605, 1.323153018951416, 1.3787052631378174, 1.4348092079162598, 1.306875467300415, 1.362865686416626, 1.3088345527648926, 1.4738409519195557, 1.2952370643615723, 0.7717306613922119, -1.2219247817993164, -1.3175005912780762, -1.3911597728729248, -1.3679471015930176, -1.3390915393829346, -1.37764310836792, -1.3138542175292969, -1.409679889678955, -1.3689725399017334, -0.6138110756874084, 1.225487232208252, 1.2933690547943115, 1.4623587131500244, 1.2805745601654053, 1.4160776138305664, 1.29414701461792, 1.325622797012329, 1.45926833152771, 1.4248411655426025, 0.7453131675720215, -1.335871696472168, -1.2360234260559082, -1.445469617843628, -1.3430254459381104, -1.2864103317260742, -1.433560848236084, -1.2262415885925293, -1.4942021369934082, -1.2518689632415771, -0.7331094741821289, 1.1678647994995117, 1.4077770709991455, 1.3347160816192627, 1.3645353317260742, 1.365614891052246, 1.3105244636535645, 1.4312102794647217, 1.4089760780334473, 1.363297700881958, 0.7118233442306519, -1.2350592613220215, -1.336984634399414, -1.4339854717254639, -1.2924957275390625, -1.3258943557739258, -1.3025469779968262, -1.2680270671844482, -1.5208258628845215, -1.2822904586791992, -0.7983718514442444, 1.2207987308502197, 1.3746554851531982, 1.3970794677734375, 1.409736156463623, 1.3224635124206543, 1.387453556060791, 1.2474517822265625, 1.460082769393921, 1.3998878002166748, 0.7864193320274353, -1.270507574081421, -1.3007981777191162, -1.422478199005127, -1.3762953281402588, -1.266479730606079, -1.3623976707458496, -1.3066349029541016, -1.4209139347076416, -1.4056341648101807, -0.7082375288009644, 1.2469449043273926, 1.3158063888549805, 1.3609161376953125, 1.4416162967681885, 1.2908501625061035, 1.328644037246704, 1.355194091796875, 1.4329915046691895, 1.4289002418518066, 0.7299340963363647, -1.1474578380584717, -1.3331196308135986, -1.37740159034729, -1.393782138824463, -1.3927924633026123, -1.2463181018829346, -1.4434950351715088, -1.2986679077148438, -1.3830626010894775, -0.7344464659690857, 1.2756264209747314, 1.3039307594299316, 1.344768762588501, 1.3991320133209229, 1.263552188873291, 1.4011478424072266, 1.3458268642425537, 1.429941177368164, 1.373917579650879, 0.7281972169876099, -1.190183401107788, -1.2589352130889893, -1.4282808303833008, -1.310908555984497, -1.3950309753417969, -1.259406328201294, -1.3251521587371826, -1.4318416118621826, -1.3518311977386475, -0.8110368847846985, 1.2978341579437256, 1.212484359741211, 1.4310636520385742, 1.3689210414886475, 1.3467981815338135, 1.355950117111206, 1.3490588665008545, 1.4579365253448486, 1.3128910064697266, 0.8408010601997375, -1.2075519561767578, -1.2896490097045898, -1.4562098979949951, -1.3260200023651123, -1.3175115585327148, -1.2774574756622314, -1.3868532180786133, -1.4034669399261475, -1.321218729019165, -0.7632417678833008, 1.1218841075897217, 1.314863681793213, 1.4346888065338135, 1.3339571952819824, 1.3803999423980713, 1.3540563583374023, 1.3267552852630615, 1.5005061626434326, 1.3279616832733154, 0.8539538979530334, -1.233449935913086, -1.3385717868804932, -1.4226410388946533, -1.266094446182251, -1.3425700664520264, -1.3675782680511475, -1.327239990234375, -1.4615023136138916, -1.312269687652588, -0.796037495136261, 1.285721778869629, 1.3050403594970703, 1.4155516624450684, 1.3153693675994873, 1.3437309265136719, 1.2937607765197754, 1.416597604751587, 1.4675860404968262, 1.2958147525787354, 0.8835998773574829, -1.1891777515411377, -1.2961516380310059, -1.423102855682373, -1.4027471542358398, -1.2710795402526855, -1.3174824714660645, -1.3552696704864502, -1.3873021602630615, -1.4042880535125732, -0.7933663129806519, 1.1999561786651611, 1.2747302055358887, 1.3850178718566895, 1.4032049179077148, 1.3149425983428955, 1.3518707752227783, 1.3909709453582764, 1.3401250839233398, 1.4197566509246826, 1.3766355514526367, 1.3297996520996094, 1.3377673625946045, 1.3797509670257568, 1.3154001235961914, 1.474283218383789, 1.3291339874267578, 1.371896743774414, 1.2376611232757568, 1.4047644138336182, 1.3789281845092773, 1.2928805351257324, 1.4148471355438232, 1.3883624076843262, 1.2766292095184326, 1.4101336002349854, 1.3159708976745605, 1.4164531230926514, 1.3462271690368652, 1.3003015518188477, 1.3842437267303467, 1.3179500102996826, 1.4015872478485107, 1.3340020179748535, 1.4159679412841797, 1.4020590782165527, 1.2590999603271484, 1.3974730968475342, 1.3111238479614258, 1.3785505294799805, 1.3120307922363281, 1.4462347030639648, 1.328927755355835, 1.3722293376922607, 1.3872408866882324, 1.3250811100006104, 1.3059289455413818, 1.3947439193725586, 1.442791223526001, 1.3603453636169434, 0.8306475877761841, -1.156609058380127, -1.3011229038238525, -1.4203243255615234, -1.3685908317565918, -1.3117702007293701, -1.3145930767059326, -1.2931950092315674, -1.4018654823303223, -1.3928022384643555, -0.8094522953033447, 1.1479699611663818, 1.3015823364257812, 1.3979012966156006, 1.3837049007415771, 1.3206915855407715, 1.3525023460388184, 1.3410582542419434, 1.3996739387512207, 1.38877272605896, 1.357823371887207, 1.2989413738250732, 1.3461096286773682, 1.3528635501861572, 1.3825230598449707, 1.3929085731506348, 1.324840784072876, 1.336115837097168, 1.3989405632019043, 1.3206415176391602, 0.9413597583770752, -1.1411008834838867, -1.3217530250549316, -1.413024663925171, -1.28155517578125, -1.3308186531066895, -1.3018271923065186, -1.3983674049377441, -1.3576455116271973, -1.3926477432250977, -0.8472530841827393, 1.0870070457458496, 1.330162763595581, 1.4636828899383545, 1.3620102405548096, 1.3252315521240234, 1.3524439334869385, 1.3483338356018066, 1.4060468673706055, 1.3228914737701416, 1.3306584358215332, 1.3722765445709229, 1.3403816223144531, 1.400987148284912, 1.360006332397461, 1.4122800827026367, 1.3236215114593506, 1.3754584789276123, 1.2948436737060547, 1.3626315593719482, 1.3549749851226807, 1.3408913612365723, 1.4079158306121826, 1.306441307067871, 1.411001205444336, 1.3963549137115479, 1.3644587993621826, 1.2627229690551758, 1.4437377452850342, 1.3381609916687012, 0.9534385204315186, -1.0983211994171143, -1.3127367496490479, -1.394719123840332, -1.4175403118133545, -1.2897679805755615, -1.2952566146850586, -1.3934147357940674, -1.3042113780975342, -1.3731591701507568, -1.337064266204834, -1.3206212520599365, -1.3657317161560059, -1.3152575492858887, -1.3666186332702637, -1.3002293109893799, -1.3674540519714355, -1.3199899196624756, -1.4206571578979492, -1.3181860446929932, -0.9663361310958862, 1.0306587219238281, 1.4798870086669922, 1.3753466606140137, 1.2753949165344238, 1.3823573589324951, 1.3559484481811523, 1.3433334827423096, 1.4389941692352295, 1.3652570247650146, 0.8827232718467712, -1.092371940612793, -1.2846179008483887, -1.351919412612915, -1.3199365139007568, -1.3680384159088135, -1.3553109169006348, -1.3160936832427979, -1.4228806495666504, -1.2760465145111084, -0.9430364966392517, 1.0190284252166748, 1.395503282546997, 1.3942515850067139, 1.4057321548461914, 1.2787094116210938, 1.41556715965271, 1.2811777591705322, 1.4800167083740234, 1.3239707946777344, 0.9660530686378479, -1.1100821495056152, -1.3273780345916748, -1.3693745136260986, -1.4167423248291016, -1.219163417816162, -1.3347141742706299, -1.3670053482055664, -1.3971083164215088, -1.2870895862579346, -1.050281286239624, 1.0985710620880127, 1.383164882659912, 1.422832727432251, 1.3240885734558105, 1.337482213973999, 1.2995970249176025, 1.3862197399139404, 1.3658227920532227, 1.3566973209381104, 1.3600983619689941, 1.3308300971984863, 1.4169471263885498, 1.31778883934021, 1.3944358825683594, 1.32169508934021, 1.3743619918823242, 1.363619089126587, 1.4059693813323975, 1.2718870639801025, 0.9990811347961426, -0.9797211289405823, -1.332174301147461, -1.449157953262329, -1.3324012756347656, -1.3547132015228271, -1.2835800647735596, -1.345367193222046, -1.417207956314087, -1.3006911277770996, -0.9988405108451843, 1.0477397441864014, 1.3237626552581787, 1.4520704746246338, 1.3356940746307373, 1.4201786518096924, 1.3199996948242188, 1.3557517528533936, 1.412285327911377, 1.3125958442687988, 1.040585994720459, -1.078845739364624, -1.3170552253723145, -1.3662505149841309, -1.363321304321289, -1.3294732570648193, -1.3186986446380615, -1.3881251811981201, -1.3868424892425537, -1.3171155452728271, -0.9404170513153076, 0.977787971496582, 1.3601491451263428, 1.398362398147583, 1.3958628177642822, 1.307831048965454, 1.4027125835418701, 1.4024658203125, 1.364764928817749, 1.3081402778625488, 1.4458386898040771, 1.2626323699951172, 1.327815294265747, 1.402146816253662, 1.3413264751434326, 1.3727166652679443, 1.3914730548858643, 1.3295316696166992, 1.4004383087158203, 1.3761909008026123, 1.347543478012085, 1.3351597785949707, 1.3922324180603027, 1.309025526046753, 1.3494808673858643, 1.4040939807891846, 1.2949106693267822, 1.4149839878082275, 1.2823386192321777, 1.3604953289031982, 1.3171236515045166, 1.4048621654510498, 1.3257994651794434, 1.3968396186828613, 1.3532240390777588, 1.3773229122161865, 1.3668527603149414, 1.3870551586151123, 1.3042232990264893, 1.322957992553711, 1.3663403987884521, 1.3860232830047607, 1.4062459468841553, 1.349273681640625, 1.3573570251464844, 1.348327398300171, 1.3135085105895996, 1.3459804058074951, 1.3980793952941895, 1.3502750396728516, 1.0479586124420166, -0.9971299767494202, -1.2868454456329346, -1.4282491207122803, -1.2972338199615479, -1.3893897533416748, -1.294501781463623, -1.3048982620239258, -1.4044981002807617, -1.3408288955688477, -1.0598647594451904, 0.9962379336357117, 1.3766450881958008, 1.4274768829345703, 1.3627419471740723, 1.2956156730651855, 1.3668017387390137, 1.3646271228790283, 1.3597891330718994, 1.334024429321289, 1.3660643100738525, 1.360138177871704, 1.3365705013275146, 1.3983917236328125, 1.3759257793426514, 1.2627432346343994, 1.4657366275787354, 1.365407943725586, 1.345566749572754, 1.352691888809204, 1.3656620979309082, 1.3422317504882812, 1.3228659629821777, 1.383709192276001, 1.379115343093872, 1.314889669418335, 1.3302059173583984, 1.3896887302398682, 1.3057689666748047, 1.3898553848266602, 1.392991065979004, 1.3300509452819824, 1.4288978576660156, 1.2413742542266846, 1.3995676040649414, 1.366279125213623, 1.3469252586364746, 1.3830721378326416, 1.3514738082885742, 1.3163883686065674, 1.3796684741973877, 1.3416821956634521, 1.4357962608337402, 1.3272545337677002, 1.3570938110351562, 1.3380658626556396, 1.4121360778808594, 1.3243730068206787, 1.3684284687042236, 1.3669476509094238, 1.3379535675048828, 1.3141541481018066, 1.3877253532409668, 1.404036283493042, 1.274643898010254, 1.4173576831817627, 1.344651222229004, 1.3250927925109863, 1.4410033226013184, 1.3060500621795654, 1.3472480773925781, 1.3971481323242188, 1.323894739151001, 1.3588871955871582, 1.389514446258545, 1.3467063903808594, 1.353602647781372, 1.3851046562194824, 1.3300776481628418, 1.3489775657653809, 1.3812508583068848, 1.3142774105072021, 1.391859531402588, 1.3723747730255127, 1.341862440109253, 1.3358066082000732, 1.277848482131958, 1.394850254058838, 1.4676361083984375, 1.3367185592651367, 1.0946359634399414, -0.9754592776298523, -1.274033784866333, -1.4582459926605225, -1.2397685050964355, -1.43900465965271, -1.3091013431549072, -1.3482046127319336, -1.265425443649292, -1.4104726314544678, -1.2770447731018066, -1.3564748764038086, -1.3904333114624023, -1.3771228790283203, -1.3598921298980713, -1.321772813796997, -1.3334500789642334, -1.285485029220581, -1.303377389907837, -1.4138514995574951, -1.3416805267333984, -1.3844964504241943, -1.303515911102295, -1.3377816677093506, -1.342085599899292, -1.307985782623291, -1.455207109451294, -1.2340173721313477, -1.3679654598236084, -1.3477838039398193, -1.3948800563812256, -1.2797961235046387, -1.3664329051971436, -1.377321481704712, -1.2292633056640625, -1.4091804027557373, -1.2714359760284424, -1.4121384620666504, -1.3673322200775146, -1.309901237487793, -1.371988296508789, -1.3023674488067627, -1.3255338668823242, -1.3775196075439453, -1.3743681907653809, -1.415440559387207, -1.2279706001281738, -1.3995847702026367, -1.28379225730896, -1.335906744003296, -1.0779695510864258, 0.8069919943809509, 1.3477106094360352, 1.5002639293670654, 1.3413758277893066, 1.3029534816741943, 1.374297857284546, 1.2974853515625, 1.4101431369781494, 1.3030123710632324, 1.4200046062469482, 1.3117284774780273, 1.363800287246704, 1.4078426361083984, 1.329923391342163, 1.4258546829223633, 1.2895476818084717, 1.3625805377960205, 1.4029533863067627, 1.3411145210266113, 1.0984628200531006, -0.7791302800178528, -1.3657469749450684, -1.4611973762512207, -1.341409683227539, -1.242361307144165, -1.330519199371338, -1.4676637649536133, -1.308159351348877, -1.3308217525482178, -1.1083002090454102, 0.811403751373291, 1.3656880855560303, 1.5060839653015137, 1.2570762634277344, 1.4300312995910645, 1.2426092624664307, 1.4109704494476318, 1.3461065292358398, 1.3916981220245361, 1.3593823909759521, 1.3521347045898438, 1.3338508605957031, 1.3839030265808105, 1.3976538181304932, 1.349440336227417, 1.2767155170440674, 1.3667304515838623, 1.4096269607543945, 1.3589355945587158, 1.1290502548217773, -0.8196434378623962, -1.3699700832366943, -1.3328359127044678, -1.379042148590088, -1.3315739631652832, -1.3840980529785156, -1.2957262992858887, -1.3031864166259766, -1.349794626235962, -1.4079577922821045, -1.306447982788086, -1.3174359798431396, -1.4255239963531494, -1.3544654846191406, -1.3181555271148682, -1.315053939819336, -1.3335468769073486, -1.3835182189941406, -1.2394137382507324, -1.4553308486938477, -1.363682508468628, -1.328493356704712, -1.2887234687805176, -1.2930009365081787, -1.3853986263275146, -1.3224828243255615, -1.3477246761322021, -1.3856048583984375, -1.3316137790679932, -1.3128087520599365, -1.3984026908874512, -1.2554106712341309, -1.3509206771850586, -1.3738129138946533, -1.346222162246704, -1.3466742038726807, -1.3182575702667236, -1.4263825416564941, -1.272669792175293, -1.2098562717437744, 0.8665122389793396, 1.3380811214447021, 1.4435787200927734, 1.3329908847808838, 1.3247756958007812, 1.3760027885437012, 1.3842759132385254, 1.355276346206665, 1.3193976879119873, 1.3589138984680176, 1.3773880004882812, 1.4100356101989746, 1.2937803268432617, 1.3361091613769531, 1.4108929634094238, 1.3348321914672852, 1.3637049198150635, 1.395298957824707, 1.3605711460113525, 1.0977473258972168, -0.6719590425491333, -1.4035723209381104, -1.468916416168213, -1.2641522884368896, -1.3916373252868652, -1.252152919769287, -1.4055240154266357, -1.2828929424285889, -1.3901903629302979, -1.3771157264709473, -1.2765960693359375, -1.3937435150146484, -1.3277363777160645, -1.3531618118286133, -1.2954866886138916, -1.3576226234436035, -1.2749199867248535, -1.3599121570587158, -1.407116413116455, -1.3574392795562744, -1.3140792846679688, -1.294565200805664, -1.3813245296478271, -1.314061164855957, -1.3969597816467285, -1.3187644481658936, -1.3647167682647705, -1.2892720699310303, -1.4154682159423828, -1.2900221347808838, -1.321739912033081, -1.3448848724365234, -1.3196465969085693, -1.327540636062622, -1.417525053024292, -1.2632958889007568, -1.420208215713501, -1.3780581951141357, -1.2935690879821777, -1.3664803504943848, -1.3194351196289062, -1.365607500076294, -1.3762385845184326, -1.2629971504211426, -1.3981788158416748, -1.3187122344970703, -1.3554542064666748, -1.4043893814086914, -1.2584435939788818, -1.1896946430206299, 0.7248902916908264, 1.3335814476013184, 1.460228681564331, 1.334925651550293, 1.4119064807891846, 1.3138909339904785, 1.3851706981658936, 1.3832201957702637, 1.2592992782592773, 1.2120473384857178, -0.6543853878974915, -1.3793885707855225, -1.320542812347412, -1.3989133834838867, -1.3095307350158691, -1.3972041606903076, -1.3015758991241455, -1.3435173034667969, -1.365443229675293, -1.3121616840362549, -1.4119846820831299, -1.2723033428192139, -1.332331657409668, -1.3536078929901123, -1.3453078269958496, -1.4007835388183594, -1.2908024787902832, -1.383389949798584, -1.3683335781097412, -1.2846243381500244, -1.4046142101287842, -1.2459001541137695, -1.3923628330230713, -1.2862677574157715, -1.3892920017242432, -1.3753669261932373, -1.2762060165405273, -1.404541015625, -1.3133509159088135, -1.3794925212860107, -1.2469115257263184, -1.424412727355957, -1.2908060550689697, -1.4253954887390137, -1.224430799484253, -1.4843394756317139, -1.2860803604125977, -1.3152589797973633, -1.426088809967041, -1.2126595973968506, -1.396083116531372, -1.3028411865234375, -1.3577022552490234, -1.4080839157104492, -1.3506121635437012, -1.3313474655151367, -1.2872235774993896, -1.3655056953430176, -1.2868919372558594, -1.4630804061889648, -1.2314627170562744, -1.4552161693572998, -1.2741115093231201, -1.3465659618377686, -1.3621349334716797, -1.306610345840454, -1.3534047603607178, -1.3279588222503662, -1.3608019351959229, -1.3555254936218262, -1.2769625186920166, -1.4158406257629395, -1.2814881801605225, -1.3615012168884277, -1.353060007095337, -1.386554479598999, -1.3077466487884521, -1.2854371070861816, -1.4312288761138916, -1.3317699432373047, -1.3261559009552002, -1.2871174812316895, -1.4413831233978271, -1.2599005699157715, -1.2860801219940186, -1.3392770290374756, -1.3843958377838135, -1.4374732971191406, -1.3051044940948486, -1.2412152290344238, 0.6480594873428345, 1.392789363861084, 1.4730663299560547, 1.35935640335083, 1.3094885349273682, 1.376178503036499, 1.3226251602172852, 1.3855645656585693, 1.4319260120391846, 1.1643388271331787, -0.6020410060882568, -1.4153330326080322, -1.3885307312011719, -1.3867552280426025, -1.189481258392334, -1.4781086444854736, -1.217637062072754, -1.4533562660217285, -1.242997169494629, -1.4000358581542969, -1.40049409866333, -1.3593266010284424, -1.2389278411865234, -1.4043307304382324, -1.3421554565429688, -1.304703712463379, -1.3473026752471924, -1.2917773723602295, -1.3804261684417725, -1.3967459201812744, -1.241703748703003, -1.3985025882720947, -1.329446792602539, -1.3225345611572266, -1.4264488220214844, -1.3195736408233643, -1.3486995697021484, -1.2938578128814697, -1.340900182723999, -1.35758376121521, -1.335832118988037, -1.3745148181915283, -1.3361618518829346, -1.37337327003479, -1.2730021476745605, -1.370818853378296, -1.278989553451538, -1.4395391941070557, -1.275536298751831, -1.3704195022583008, -1.3448734283447266, -1.2885422706604004, -1.4102020263671875, -1.3364722728729248, -1.3251292705535889, -1.3082170486450195, -1.4198989868164062, -1.3166146278381348, -1.3503310680389404, -1.3092570304870605, -1.3307833671569824, 0.0])

b = np.ones((int(np.floor(spb/2)*2),))
b[int(len(h)/2):] = -1
b = b / len(b)
a = np.array(1.)
xf = signal.lfilter(b, a, x)

# Hysteresis detector
hys = np.zeros(xf.size)
hys_pos = xf>0.5
hys_neg = xf<-0.5
state = 0
n = 0
for up, dn in zip(hys_pos, hys_neg):
    if up:
        hys[n] = 1
    elif dn:
        hys[n] = -1
    elif n>0:
        hys[n] = hys[n-1]
    n += 1

# Correlate to sync
# sync = np.concatenate((np.ones((spb,)), -1*np.ones((spb,))))
# sync = np.concatenate((sync, sync, sync, sync, sync, sync, sync, sync, sync, sync, sync, sync, sync, sync, sync))
# sync = np.concatenate((-1*np.ones((2*spb,)), sync))
# sync = np.concatenate((sync, np.ones((2*spb,))))
# xc = np.correlate(hys, sync)
start = np.argmax(hys)
bits = hys[start+1::spb]

L = len(xf)
t = np.arange(0.0, L, 1)/fs
tb = (np.arange(0.0, len(bits), 1) + start/spb) / bps
fig, ax = plt.subplots()
ax.plot(t, x)
ax.plot(t, xf)
ax.plot(t, hys)
ax.stem(tb, bits)
ax.set(xlabel='time (s)', ylabel='voltage (mV)',
       title='bits')
ax.grid()
plt.show()

